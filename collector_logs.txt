{"message": "Error upserting card 755: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('755', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 656745))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('755', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 656745))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 756: {'card_serial': '756', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '02 - INFORR-PFG-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 17, 660713)}"}
{"message": "Error upserting card 756: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('756', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 660713))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('756', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 660713))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 759: {'card_serial': '759', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '05 - INFORR-RNP-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 17, 665060)}"}
{"message": "Error upserting card 759: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('759', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 665060))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('759', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 665060))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 760: {'card_serial': '760', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '04 - INFORR-RNP-JNDA', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 17, 669002)}"}
{"message": "Error upserting card 760: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('760', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 669002))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('760', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 669002))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 761: {'card_serial': '761', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '05 - INFORR-RNP-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 17, 673022)}"}
{"message": "Error upserting card 761: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('761', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 673022))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('761', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 673022))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 762: {'card_serial': '762', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '04 - INFORR-RNP-JNDA', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 17, 677092)}"}
{"message": "Error upserting card 762: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('762', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 677092))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('762', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 677092))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 5480353: {'card_serial': '5480353', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '06-INFORR-RNP-NVP', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 17, 681671)}"}
{"message": "Error upserting card 5480353: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('5480353', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '06-INFORR-RNP-NVP', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 681671))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('5480353', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '06-INFORR-RNP-NVP', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 17, 681671))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Card collection completed: 10 cards processed"}
INFO:     172.20.0.6:39780 - "POST /collector/sync-sites HTTP/1.1" 200 OK
{"message": "Running job \"Collect Critical Measurements (trigger: interval[0:00:30], next run at: 2025-12-05 02:30:11 UTC)\" (scheduled at 2025-12-05 02:29:41.633556+00:00)"}
{"message": "Starting critical measurements collection"}
{"message": "No cards found in database, fetching from API"}
{"message": "Starting card collection"}
{"message": "HTTP Request: GET http://108.165.140.144:8181/nms-api/v1/inventory/state \"HTTP/1.1 200 OK\""}
{"message": "Fetched 10 cards from API"}
{"message": "Upserting card 294: {'card_serial': '294', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '01 - INFORR-MNS-KTG', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 759442)}"}
{"message": "Error upserting card 294: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('294', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '01 - INFORR-MNS-KTG', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 759442))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('294', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '01 - INFORR-MNS-KTG', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 759442))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 753: {'card_serial': '753', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '03 - INFORR-ABNR-01', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 765028)}"}
{"message": "Error upserting card 753: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('753', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 765028))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('753', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 765028))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 754: {'card_serial': '754', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '02 - INFORR-PFG-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 770509)}"}
{"message": "Error upserting card 754: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('754', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 770509))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('754', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 770509))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 755: {'card_serial': '755', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '03 - INFORR-ABNR-01', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 775077)}"}
{"message": "Error upserting card 755: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('755', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 775077))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('755', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 775077))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 756: {'card_serial': '756', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '02 - INFORR-PFG-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 779120)}"}
{"message": "Error upserting card 756: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('756', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 779120))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('756', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 779120))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 759: {'card_serial': '759', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '05 - INFORR-RNP-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 783466)}"}
{"message": "Error upserting card 759: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('759', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 783466))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('759', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 783466))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 760: {'card_serial': '760', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '04 - INFORR-RNP-JNDA', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 787989)}"}
{"message": "Error upserting card 760: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('760', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 787989))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('760', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 787989))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 761: {'card_serial': '761', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '05 - INFORR-RNP-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 793036)}"}
{"message": "Error upserting card 761: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('761', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 793036))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('761', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 793036))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 762: {'card_serial': '762', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '04 - INFORR-RNP-JNDA', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 797576)}"}
{"message": "Error upserting card 762: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('762', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 797576))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('762', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 797576))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 5480353: {'card_serial': '5480353', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '06-INFORR-RNP-NVP', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 29, 41, 801298)}"}
{"message": "Error upserting card 5480353: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('5480353', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '06-INFORR-RNP-NVP', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 801298))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('5480353', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '06-INFORR-RNP-NVP', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 29, 41, 801298))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Card collection completed: 10 cards processed"}
{"message": "Measurements collection completed: 0 measurements processed"}
{"message": "Job \"Collect Critical Measurements (trigger: interval[0:00:30], next run at: 2025-12-05 02:30:11 UTC)\" executed successfully"}
{"message": "Running job \"Collect Critical Measurements (trigger: interval[0:00:30], next run at: 2025-12-05 02:30:41 UTC)\" (scheduled at 2025-12-05 02:30:11.633556+00:00)"}
{"message": "Starting critical measurements collection"}
{"message": "No cards found in database, fetching from API"}
{"message": "Starting card collection"}
{"message": "HTTP Request: GET http://108.165.140.144:8181/nms-api/v1/inventory/state \"HTTP/1.1 200 OK\""}
{"message": "Fetched 10 cards from API"}
{"message": "Upserting card 294: {'card_serial': '294', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '01 - INFORR-MNS-KTG', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 665985)}"}
{"message": "Error upserting card 294: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('294', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '01 - INFORR-MNS-KTG', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 665985))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('294', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '01 - INFORR-MNS-KTG', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 665985))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 753: {'card_serial': '753', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '03 - INFORR-ABNR-01', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 670245)}"}
{"message": "Error upserting card 753: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('753', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 670245))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('753', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 670245))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 754: {'card_serial': '754', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '02 - INFORR-PFG-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 675837)}"}
{"message": "Error upserting card 754: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('754', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 675837))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('754', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 675837))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 755: {'card_serial': '755', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '03 - INFORR-ABNR-01', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 679835)}"}
{"message": "Error upserting card 755: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('755', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 679835))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('755', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '03 - INFORR-ABNR-01', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 679835))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 756: {'card_serial': '756', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '02 - INFORR-PFG-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 685696)}"}
{"message": "Error upserting card 756: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('756', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 685696))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('756', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '02 - INFORR-PFG-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 685696))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 759: {'card_serial': '759', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '05 - INFORR-RNP-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 690215)}"}
{"message": "Error upserting card 759: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('759', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 690215))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('759', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 690215))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 760: {'card_serial': '760', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '04 - INFORR-RNP-JNDA', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 694025)}"}
{"message": "Error upserting card 760: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('760', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 694025))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('760', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 694025))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 761: {'card_serial': '761', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '05 - INFORR-RNP-CNT', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 698102)}"}
{"message": "Error upserting card 761: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('761', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 698102))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('761', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '05 - INFORR-RNP-CNT', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 698102))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 762: {'card_serial': '762', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '04 - INFORR-RNP-JNDA', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 704236)}"}
{"message": "Error upserting card 762: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('762', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 704236))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('762', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '04 - INFORR-RNP-JNDA', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 704236))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Upserting card 5480353: {'card_serial': '5480353', 'card_part': 2262, 'card_family': 'MUX_DEMUX', 'card_model': 'MDDC21401ST2', 'location_site': '06-INFORR-RNP-NVP', 'slot_number': None, 'status': 'UNKNOWN', 'installed_at': None, 'last_updated': datetime.datetime(2025, 12, 5, 2, 30, 11, 711734)}"}
{"message": "Error upserting card 5480353: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('5480353', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '06-INFORR-RNP-NVP', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 711734))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)"}
{"message": "Traceback (most recent call last):\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\n  File \"asyncpg/protocol/codecs/base.pyx\", line 227, in asyncpg.protocol.protocol.Codec.encode\n  File \"asyncpg/protocol/codecs/base.pyx\", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 29, in asyncpg.pgproto.pgproto.text_encode\n  File \"asyncpg/pgproto/./codecs/text.pyx\", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size\nTypeError: expected str, got int\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg/protocol/protocol.pyx\", line 186, in bind_execute\n  File \"asyncpg/protocol/prepared_stmt.pyx\", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg\nasyncpg.exceptions.DataError: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/database.py\", line 109, in upsert_card\n    result = await session.execute(query, params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2199, in _execute_internal\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $2: 2262 (expected str, got int)\n[SQL: \n                    INSERT INTO cards (\n                        card_serial, card_part, card_family, card_model,\n                        location_site, slot_number, status, installed_at, last_updated\n                    ) VALUES (\n                        $1, $2, $3, $4,\n                        $5, $6, $7, $8, $9\n                    )\n                    ON CONFLICT (card_serial) DO UPDATE SET\n                        card_part = EXCLUDED.card_part,\n                        card_family = EXCLUDED.card_family,\n                        card_model = EXCLUDED.card_model,\n                        location_site = EXCLUDED.location_site,\n                        slot_number = EXCLUDED.slot_number,\n                        status = EXCLUDED.status,\n                        last_updated = EXCLUDED.last_updated\n                ]\n[parameters: ('5480353', 2262, 'MUX_DEMUX', 'MDDC21401ST2', '06-INFORR-RNP-NVP', None, 'UNKNOWN', None, datetime.datetime(2025, 12, 5, 2, 30, 11, 711734))]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\n"}
{"message": "Card collection completed: 10 cards processed"}
{"message": "Measurements collection completed: 0 measurements processed"}
{"message": "Job \"Collect Critical Measurements (trigger: interval[0:00:30], next run at: 2025-12-05 02:30:41 UTC)\" executed successfully"}
